<!DOCTYPE html>
<html lang="en">
	<head>
		<title> Starship Academy </title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<script src="/jquery/dist/jquery.min.js"></script>
		<script src="/bundle.js"></script>
		<script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
  	<script src="https://rawgit.com/mayognaise/aframe-gif-component/master/dist/aframe-gif-component.min.js"></script>
	</head>
	<body id="mainApp">

		<a-scene id="scene" scene-load>
			<a-asset>
				<img id="space" src="./src/assets/images/space.jpg">
				<img id="asteroid" src="./src/assets/images/asteroid.jpg">
				<img id="explosion" src="./src/assets/images/explosion.jpg">
				<img id="crosshair" src="./src/assets/images/crosshair.png">
				<img id="hud1" src="./src/assets/images/hud_1.gif">
				<img id="hud2" src="./src/assets/images/hud_2.gif">
				<img id="hud3" src="./src/assets/images/hud_3.jpg">
				<img id="hud4" src="./src/assets/images/hud_4.gif">
				<img id="hud5" src="./src/assets/images/hud_5.jpg">
				<img id="hud6" src="./src/assets/images/hud_6.gif">
				<img id="hud7" src="./src/assets/images/hud_7.png">
				<img id="hud9" src="./src/assets/images/hud_9.png">
				<img id="hud9" src="./src/assets/images/hud_9.png">
				<img id="hud_top" src="./src/assets/images/hud_top.png">

				<audio id="gameplay" src="./src/assets/sounds/SpaceCube.ogg">
				<audio id="laser_shot" src="./src/assets/sounds/Laser.ogg">

				<a-asset-item id="arc170-obj" src="./src/assets/models/arc170/arc170.obj"></a-asset-item>
        <a-asset-item id="arc170-mtl" src="./src/assets/models/arc170/arc170.mtl"></a-asset-item>

        <a-mixin id="asteroid1" geometry="primitive: sphere; radius:2" material="src: #asteroid"></a-mixin>
        <a-mixin id="asteroid2" geometry="primitive: sphere; radius:4" material="src: #asteroid"></a-mixin>

        <a-mixin id="position" random-spherical-position="radius: 40; startX: 0; lengthX: 360; startY: 0; lengthY: 360" random-rotation random-position="min: -100 -100 -100; max: 100 100 100"></a-mixin>

				<a-mixin id="laser"
					geometry="primitive: cylinder; radius: 0.1; height: 8"
					rotation="-90 0 0"
					translate="0 -2 0"
					material="color: yellow; metalness: 0.2; opacity: 0.8; roughness: 0.3"
					projectile="speed: 0.02"
					sound="src: #laser_shot; on: click; autoplay: true; volume: 1"></a-mixin>
      </a-asset>
      <a-entity entity-generator="mixin: asteroid1 position; num: 150;"></a-entity>
      <a-entity entity-generator="mixin: asteroid2 position; num: 150;"></a-entity>

			<a-entity entity-generator="mixin: octa position; num: 50;">

			<a-sky src="./src/assets/images/space.jpg"></a-sky>
    </a-scene>
    <script>
       	let enemies = document.querySelectorAll('.enemy');
         let deadEnemies = [];
         let points = 0;
         let increaseCounter = function(e) {
          	let enemy = e.currentTarget;
           if (deadEnemies.indexOf(enemy) !== -1) { return; }
           deadEnemies.push(enemy);
           points+=1;
           let score_entity = document.getElementById('score');
           score_entity.setAttribute('bmfont-text', `text: Score:${points}; fnt: ./src/assets/fonts/DejaVu-sdf.fnt; fntImage: ./src/assets/fonts/DejaVu-sdf.png; color: #f44336; lineHeight:30; letterSpacing: 6`);
         };
         enemies = Array.prototype.slice.call(enemies);
         enemies.forEach(function (enemyEl) {
           enemyEl.addEventListener('hit', increaseCounter);
         });
       </script>
	</body>
</html>
